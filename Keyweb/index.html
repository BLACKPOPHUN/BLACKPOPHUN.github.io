<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Get Key</title>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<style>
body{background:#0f0f0f;color:white;font-family:sans-serif;text-align:center;padding:40px}
input,button{padding:12px;font-size:16px;margin:5px}
pre{background:#1a1a1a;padding:15px;margin-top:20px}
</style>
</head>
<body>

<h2>üîë ‡∏£‡∏±‡∏ö Key (12 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</h2>
<input id="uid" placeholder="UserId Roblox">
<br>
<button id="btn" onclick="createKey()">‡∏£‡∏±‡∏ö Key</button>

<pre id="out">‡∏Å‡∏£‡∏≠‡∏Å UserId ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏£‡∏±‡∏ö‡∏Ñ‡∏µ‡∏¢‡πå</pre>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyA4nwk8ZPeVvoLOR4UyPLP-yVUyhlinEN8",
  authDomain: "blackpophun.firebaseapp.com",
  databaseURL: "https://blackpophun-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "blackpophun",
  storageBucket: "blackpophun.appspot.com",
  messagingSenderId: "735578888290",
  appId: "1:735578888290:web:b68c60a5bdba76880ed93b"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

function genKey(){
  return "BP-" +
    Math.random().toString(36).substr(2,4).toUpperCase() +
    "-" +
    Math.random().toString(36).substr(2,4).toUpperCase();
}

function createKey(){
  const uid = document.getElementById("uid").value.trim();
  if(!uid) return alert("‡∏Å‡∏£‡∏≠‡∏Å UserId");

  db.ref("users/"+uid).once("value").then(snap=>{
    if(snap.exists() && Date.now() < snap.val().expire){
      document.getElementById("btn").disabled = true;
      document.getElementById("out").textContent =
        "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ Key ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß\nKEY: "+snap.val().key+
        "\n‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: "+new Date(snap.val().expire).toLocaleString();
      return;
    }

    const key = genKey();
    const expire = Date.now() + 12*60*60*1000;

    db.ref("users/"+uid).set({ key, expire });
    db.ref("keys/"+key).set({ uid, expire });

    document.getElementById("btn").disabled = true;
    document.getElementById("out").textContent =
      "KEY: "+key+
      "\n‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: "+new Date(expire).toLocaleString();
  });
}
</script>

</body>
</html>
